<!-- src/app/features/tasks/pages/task-list.component.html -->
<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-title>
      <div class="header-content">
        <div class="logo-container">
          <ion-icon name="briefcase-outline"></ion-icon>
        </div>
        <div class="title-wrapper">
          <h1 class="main-title">Task Manager</h1>
          <p class="subtitle">Organize your day efficiently</p>
        </div>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="content-container">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card stat-total">
        <div class="stat-icon-wrapper">
          <ion-icon name="list-outline"></ion-icon>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ tasks().length }}</span>
          <span class="stat-label">Total Tasks</span>
        </div>
      </div>

      <div class="stat-card stat-pending">
        <div class="stat-icon-wrapper">
          <ion-icon name="time-outline"></ion-icon>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ pendingCount() }}</span>
          <span class="stat-label">Pending</span>
        </div>
      </div>

      <div class="stat-card stat-completed">
        <div class="stat-icon-wrapper">
          <ion-icon name="checkmark-circle-outline"></ion-icon>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ completedCount() }}</span>
          <span class="stat-label">Completed</span>
        </div>
      </div>
    </div>

    <!-- Quick Add Task -->
    <div class="quick-add-section">
      <h2 class="section-title">
        <ion-icon name="add-circle-outline"></ion-icon>
        Quick Add
      </h2>

      <div class="quick-add-card">
        <div class="input-group">
          <div class="input-wrapper">
            <ion-icon name="create-outline" class="input-icon"></ion-icon>
            <ion-input
              type="text"
              placeholder="What needs to be done?"
              [formControl]="taskControl"
              (keyup.enter)="submit()"
              class="task-input"
            ></ion-input>
          </div>

          <div class="category-selector">
            <ion-icon name="pricetag-outline" class="input-icon"></ion-icon>
            <ion-select
              interface="action-sheet"
              placeholder="Category"
              [formControl]="categoryControl"
              class="category-select"
            >
              @for (category of categories(); track category.id) {
                <ion-select-option [value]="category.id">
                  {{ category.name }}
                </ion-select-option>
              }
            </ion-select>
          </div>
        </div>

        <ion-button
          expand="block"
          (click)="submit()"
          [disabled]="taskControl.invalid"
          class="add-task-button"
        >
          <ion-icon slot="start" name="add-outline"></ion-icon>
          Add Task
        </ion-button>
      </div>
    </div>

    <!-- Tasks Display -->
    <div class="tasks-container">
      @if (tasks().length === 0) {
        <div class="empty-state">
          <div class="empty-illustration">
            <ion-icon name="checkmark-done-outline"></ion-icon>
          </div>
          <h3 class="empty-title">All Clear!</h3>
          <p class="empty-message">You have no tasks yet. Create your first task to get started.</p>
          <ion-button fill="outline" size="small" class="empty-action">
            <ion-icon slot="start" name="add-outline"></ion-icon>
            Create Task
          </ion-button>
        </div>
      } @else {
        <!-- Pending Tasks Section -->
        @if (pendingTasks().length > 0) {
          <div class="tasks-section">
            <div class="section-header">
              <div class="section-title-wrapper">
                <div class="section-icon pending-icon">
                  <ion-icon name="hourglass-outline"></ion-icon>
                </div>
                <div>
                  <h3 class="section-title-main">In Progress</h3>
                  <p class="section-subtitle">{{ pendingCount() }} task{{ pendingCount() !== 1 ? 's' : '' }} to complete</p>
                </div>
              </div>
            </div>

            <div class="tasks-grid">
              @for (task of pendingTasks(); track task.id) {
                <ion-item-sliding #slidingItem class="task-sliding">
                  <ion-item-options side="end">
                    <ion-item-option color="danger" (click)="deleteTask(task.id); slidingItem.close()">
                      <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
                    </ion-item-option>
                  </ion-item-options>

                  <ion-item lines="none" class="task-card pending-task">
                    <div class="task-wrapper">
                      <ion-checkbox
                        [checked]="task.completed"
                        (ionChange)="toggleTask(task.id)"
                        class="custom-checkbox"
                      ></ion-checkbox>

                      <div class="task-details">
                        <p class="task-title">{{ task.title }}</p>
                      </div>

                      <ion-button
                        fill="clear"
                        size="small"
                        (click)="deleteTask(task.id)"
                        class="task-delete-btn"
                      >
                        <ion-icon slot="icon-only" name="close-outline"></ion-icon>
                      </ion-button>
                    </div>
                  </ion-item>
                </ion-item-sliding>
              }
            </div>
          </div>
        }

        <!-- Completed Tasks Section -->
        @if (completedTasks().length > 0) {
          <div class="tasks-section completed-section">
            <div class="section-header">
              <div class="section-title-wrapper">
                <div class="section-icon completed-icon">
                  <ion-icon name="checkmark-done-outline"></ion-icon>
                </div>
                <div>
                  <h3 class="section-title-main">Completed</h3>
                  <p class="section-subtitle">{{ completedCount() }} task{{ completedCount() !== 1 ? 's' : '' }} done</p>
                </div>
              </div>

              <ion-button
                fill="clear"
                size="small"
                (click)="clearCompleted()"
                class="clear-all-btn"
              >
                <ion-icon slot="start" name="trash-outline"></ion-icon>
                Clear All
              </ion-button>
            </div>

            <div class="tasks-grid">
              @for (task of completedTasks(); track task.id) {
                <ion-item-sliding #slidingItem class="task-sliding">
                  <ion-item-options side="end">
                    <ion-item-option color="danger" (click)="deleteTask(task.id); slidingItem.close()">
                      <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
                    </ion-item-option>
                  </ion-item-options>

                  <ion-item lines="none" class="task-card completed-task">
                    <div class="task-wrapper">
                      <ion-checkbox
                        [checked]="task.completed"
                        (ionChange)="toggleTask(task.id)"
                        class="custom-checkbox"
                      ></ion-checkbox>

                      <div class="task-details">
                        <p class="task-title completed-title">{{ task.title }}</p>
                      </div>

                      <ion-button
                        fill="clear"
                        size="small"
                        (click)="deleteTask(task.id)"
                        class="task-delete-btn"
                      >
                        <ion-icon slot="icon-only" name="close-outline"></ion-icon>
                      </ion-button>
                    </div>
                  </ion-item>
                </ion-item-sliding>
              }
            </div>
          </div>
        }
      }
    </div>
  </div>
</ion-content>
