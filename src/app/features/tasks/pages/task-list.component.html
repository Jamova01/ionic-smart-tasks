<app-tasks-header
  title="Task Manager"
  subtitle="Organize your day efficiently"
  icon="briefcase-outline"
/>

<ion-content [fullscreen]="true">
  <div class="content-container">
    <!-- Stats Cards -->
    <app-stats-summary
      [total]="vm().filtered.length"
      [pending]="vm().pendingCount"
      [completed]="vm().completedCount"
    />

    <!-- Category Management Section -->
    <app-category-management
      [categories]="categories()"
      [tasks]="tasks()"
      [activeCategoryId]="selectedCategoryFilter()"
      (create)="createCategory($event)"
      (filter)="onFilterChange($event)"
      (delete)="confirmDeleteCategory($event)"
    />

    <!-- Category Filter -->
    <app-tasks-filter
      [categories]="categories()"
      [activeCategoryId]="selectedCategoryFilter()"
      (filter)="onFilterChange($event)"
    />

    <!-- Quick Add Task -->
    <app-quick-add-task [categories]="categories()" (create)="onCreateTask($event)" />

    <!-- Tasks Display -->
    <div class="tasks-container">
      @if (vm().filtered.length === 0) {
      <div class="empty-state">
        <div class="empty-illustration">
          <ion-icon name="checkmark-done-outline"></ion-icon>
        </div>

        @if (selectedCategoryFilter()) {
        <h3 class="empty-title">No tasks in this category</h3>
        <p class="empty-message">
          No tasks found for
          <strong>{{ getCategoryById(selectedCategoryFilter()!)?.name }}</strong>
        </p>
        <ion-button fill="outline" size="small" class="empty-action" (click)="onFilterChange(null)">
          <ion-icon slot="start" name="close-outline"></ion-icon>
          Clear Filter
        </ion-button>
        } @else {
        <h3 class="empty-title">All Clear!</h3>
        <p class="empty-message">You have no tasks yet. Create your first task to get started.</p>
        <ion-button fill="outline" size="small" class="empty-action">
          <ion-icon slot="start" name="add-outline"></ion-icon>
          Create Task
        </ion-button>
        }
      </div>
      } @else { @if (vm().pending.length > 0) {
      <app-tasks-section
        variant="pending"
        icon="hourglass-outline"
        [title]="'In Progress'"
        [subtitle]="
          vm().pending.length + ' task' + (vm().pending.length !== 1 ? 's' : '') + ' to complete'
        "
        [tasks]="vm().pending"
        [categories]="categories()"
        (toggle)="toggleTask($event)"
        (remove)="deleteTask($event)"
      />
      } @if (vm().completed.length > 0) {
      <app-tasks-section
        variant="completed"
        icon="checkmark-done-outline"
        [title]="'Completed'"
        [subtitle]="
          vm().completed.length + ' task' + (vm().completed.length !== 1 ? 's' : '') + ' done'
        "
        [tasks]="vm().completed"
        [categories]="categories()"
        [showAction]="true"
        actionIcon="trash-outline"
        [actionLabel]="'Clear All'"
        (action)="clearCompleted()"
        (toggle)="toggleTask($event)"
        (remove)="deleteTask($event)"
      />
      } }
    </div>
  </div>
</ion-content>
